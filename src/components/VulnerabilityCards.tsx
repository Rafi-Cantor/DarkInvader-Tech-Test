import { VulnerabilityType, ExternalLink } from "../types/VulnerabilityTypes";
import Card from "./Card";

type VulnerabilityCardsProps = {
  vulnerability: VulnerabilityType;
};

function VulnerabilityCards({ vulnerability }: VulnerabilityCardsProps) {
  return (
    <div className="card-layout">
      <Card title="General Info">
        <p>
          <strong>Severity:</strong> {vulnerability.severity}
        </p>
        <p>
          <strong>Category:</strong> {vulnerability.category}
        </p>
        <p>
          <strong>Description:</strong> {vulnerability.description}
        </p>
      </Card>
      <Card title="Affected Assets">
        {vulnerability.additional_affected_asset_fields.map(
          (affected_asset: string, index: number) => (
            <p key={index}>{affected_asset}</p>
          )
        )}
      </Card>
      <Card title="Remediation Steps">
        <p>{vulnerability.remediation}</p>
      </Card>
      <Card title="CVSS Scores and Exploit Availability">
        <p>
          <strong>CVSS Score:</strong> {vulnerability.cvss_score}
        </p>
        <p>
          <strong>CVSS3 Score:</strong> {vulnerability.cvss3_score}
        </p>
        <p>
          <strong>Exploits Available:</strong> {vulnerability.exploit_available}
        </p>
      </Card>
      <Card title="CVEs">
        <ul>
          {vulnerability.cves.map((cve: string, index: number) => (
            <li key={index}>{cve}</li>
          ))}
        </ul>
      </Card>
      <Card title="External Links">
        <ul>
          {vulnerability.external_links.map(
            (link: ExternalLink, index: number) => (
              <li key={index}>
                <a href={link.url} target="_blank" rel="noopener noreferrer">
                  {link.title}
                </a>
              </li>
            )
          )}
        </ul>
      </Card>
    </div>
  );
}

export default VulnerabilityCards;
